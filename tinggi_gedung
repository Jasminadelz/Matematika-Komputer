/*
===============================================================================
              PROGRAM PENGUKURAN TINGGI GEDUNG
                   Metode Trigonometri
===============================================================================
Program ini menggunakan konsep trigonometri untuk menghitung tinggi gedung
berdasarkan tinggi pengamat, sudut elevasi, dan jarak pengamat ke gedung.

Rumus: Tinggi Gedung = Tinggi Pengamat + (Jarak × tan(sudut elevasi))
===============================================================================
*/

#include <stdio.h>
#include <math.h>   /* Library untuk fungsi matematika seperti tan() */

/* Konstanta untuk konversi derajat ke radian */
#define PI 3.14159265358979323846

/*
===============================================================================
BAGIAN 1: FUNGSI-FUNGSI PEMBANTU
===============================================================================
*/

/* Fungsi untuk membersihkan buffer input */
void bersihkanBuffer() {
    while(getchar() != '\n');
}

/* Fungsi untuk pause program */
void tekanEnter() {
    printf("\nTekan ENTER untuk melanjutkan...");
    getchar();
    printf("\n");
}

/* Fungsi untuk konversi derajat ke radian */
/* Rumus: radian = derajat × (π / 180) */
float derajatKeRadian(float derajat) {
    return derajat * (PI / 180.0);
}

/*
===============================================================================
BAGIAN 2: FUNGSI TAMPILAN HEADER
===============================================================================
*/

void tampilkanHeader() {
    printf("\n");
    printf("=======================================================\n");
    printf("=======================================================\n");
    printf("                                                       \n");
    printf("          PROGRAM PENGUKURAN TINGGI GEDUNG             \n");
    printf("              Menggunakan Trigonometri                 \n");
    printf("                                                       \n");
    printf("=======================================================\n");
    printf("=======================================================\n");
    printf("\n");
}

/*
===============================================================================
BAGIAN 3: FUNGSI TAMPILAN ILUSTRASI
===============================================================================
*/

void tampilkanIlustrasi() {
    printf("========================================================\n");
    printf("                  ILUSTRASI PENGUKURAN\n");
    printf("========================================================\n\n");
    printf("                    ^                                   \n");
    printf("                    |                                   \n");
    printf("                    |  TINGGI                           \n");
    printf("                    |  GEDUNG                           \n");
    printf("                    |  (?)                              \n");
    printf("                    |                                   \n");
    printf("                    |                                   \n");
    printf("                  --+--  <-- Puncak Gedung              \n");
    printf("                 /  |                                   \n");
    printf("                /   |                                   \n");
    printf("               / α  |                                   \n");
    printf("         MATA/______|                                   \n");
    printf("         PENGAMAT   |                                   \n");
    printf("              |     |                                   \n");
    printf("    Tinggi -->|     |                                   \n");
    printf("    Pengamat  |     |                                   \n");
    printf("         _____|_____|_____                              \n");
    printf("              |<--->|                                   \n");
    printf("               Jarak                                    \n");
    printf("\n");
    printf("Keterangan:                                            \n");
    printf("  α (alpha) = Sudut Elevasi                            \n");
    printf("  Jarak     = Jarak horizontal pengamat ke gedung      \n");
    printf("\n");
    printf("=======================================================\n\n");
}

/*
===============================================================================
BAGIAN 4: FUNGSI INPUT DATA
===============================================================================
*/

void inputDataPengukuran(float *tinggiPengamat, float *sudutElevasi, float *jarakPengamat) {
    printf("=======================================================\n");
    printf("              INPUT DATA PENGUKURAN\n");
    printf("=======================================================\n\n");
    
    /* Input tinggi pengamat */
    printf("Masukkan tinggi badan pengamat (dalam meter): ");
    scanf("%f", tinggiPengamat);
    bersihkanBuffer();
    
    /* Input sudut elevasi */
    printf("Masukkan sudut elevasi (dalam derajat): ");
    scanf("%f", sudutElevasi);
    bersihkanBuffer();
    
    /* Input jarak pengamat ke gedung */
    printf("Masukkan jarak pengamat ke gedung (dalam meter): ");
    scanf("%f", jarakPengamat);
    bersihkanBuffer();
    
    printf("\n");
}

/*
===============================================================================
BAGIAN 5: FUNGSI VALIDASI INPUT
===============================================================================
*/

int validasiInput(float tinggiPengamat, float sudutElevasi, float jarakPengamat) {
    int valid = 1;  /* Anggap input valid, 1 = true */
    
    printf("=======================================================\n");
    printf("              VALIDASI INPUT DATA\n");
    printf("=======================================================\n\n");
    
    /* Cek tinggi pengamat (harus positif dan wajar) */
    if(tinggiPengamat <= 0 || tinggiPengamat > 3) {
        printf("ERROR: Tinggi pengamat tidak valid!\n");
        printf("       Harus antara 0 - 3 meter.\n\n");
        valid = 0;
    }
    
    /* Cek sudut elevasi (harus antara 0 - 90 derajat) */
    if(sudutElevasi <= 0 || sudutElevasi >= 90) {
        printf("ERROR: Sudut elevasi tidak valid!\n");
        printf("       Harus antara 0 - 90 derajat.\n\n");
        valid = 0;
    }
    
    /* Cek jarak pengamat (harus positif) */
    if(jarakPengamat <= 0) {
        printf("ERROR: Jarak pengamat tidak valid!\n");
        printf("       Harus lebih dari 0 meter.\n\n");
        valid = 0;
    }
    
    if(valid) {
        printf("✓ Semua input VALID!\n\n");
    }
    
    printf("=======================================================\n\n");
    
    return valid;  /* Return 1 jika valid, 0 jika tidak valid */
}

/*
===============================================================================
BAGIAN 6: FUNGSI TAMPILKAN DATA INPUT
===============================================================================
*/

void tampilkanDataInput(float tinggiPengamat, float sudutElevasi, float jarakPengamat) {
    printf("=======================================================\n");
    printf("              DATA PENGUKURAN\n");
    printf("=======================================================\n\n");
    printf("  Tinggi Badan Pengamat  : %.2f meter\n", tinggiPengamat);
    printf("  Sudut Elevasi          : %.2f derajat\n", sudutElevasi);
    printf("  Jarak ke Gedung        : %.2f meter\n", jarakPengamat);
    printf("\n=======================================================\n\n");
}

/*
===============================================================================
BAGIAN 7: FUNGSI PERHITUNGAN TINGGI GEDUNG
===============================================================================
*/

float hitungTinggiGedung(float tinggiPengamat, float sudutElevasi, float jarakPengamat) {
    float sudutRadian;      /* Sudut dalam satuan radian */
    float tinggiTambahan;   /* Tinggi dari mata pengamat ke puncak gedung */
    float tinggiTotal;      /* Tinggi total gedung */
    
    printf("=======================================================\n");
    printf("          PROSES PERHITUNGAN TRIGONOMETRI\n");
    printf("=======================================================\n\n");
    
    /* Langkah 1: Konversi sudut dari derajat ke radian */
    sudutRadian = derajatKeRadian(sudutElevasi);
    printf("Langkah 1: Konversi sudut ke radian\n");
    printf("  Sudut (radian) = %.2f × (π/180)\n", sudutElevasi);
    printf("  Sudut (radian) = %.6f radian\n\n", sudutRadian);
    
    /* Langkah 2: Hitung tinggi tambahan menggunakan tan */
    /* Rumus: tinggi tambahan = jarak × tan(sudut) */
    tinggiTambahan = jarakPengamat * tan(sudutRadian);
    printf("Langkah 2: Hitung tinggi dari mata ke puncak gedung\n");
    printf("  Tinggi tambahan = Jarak × tan(sudut)\n");
    printf("  Tinggi tambahan = %.2f × tan(%.6f)\n", jarakPengamat, sudutRadian);
    printf("  Tinggi tambahan = %.2f × %.6f\n", jarakPengamat, tan(sudutRadian));
    printf("  Tinggi tambahan = %.2f meter\n\n", tinggiTambahan);
    
    /* Langkah 3: Hitung tinggi total gedung */
    /* Rumus: tinggi total = tinggi pengamat + tinggi tambahan */
    tinggiTotal = tinggiPengamat + tinggiTambahan;
    printf("Langkah 3: Hitung tinggi total gedung\n");
    printf("  Tinggi Total = Tinggi Pengamat + Tinggi Tambahan\n");
    printf("  Tinggi Total = %.2f + %.2f\n", tinggiPengamat, tinggiTambahan);
    printf("  Tinggi Total = %.2f meter\n\n", tinggiTotal);
    
    printf("=======================================================\n\n");
    
    return tinggiTotal;
}

/*
===============================================================================
BAGIAN 8: FUNGSI TAMPILKAN HASIL
===============================================================================
*/

void tampilkanHasil(float tinggiGedung) {
    printf("=======================================================\n");
    printf("=======================================================\n");
    printf("                                                       \n");
    printf("              HASIL PENGUKURAN                         \n");
    printf("                                                       \n");
    printf("=======================================================\n");
    printf("=======================================================\n\n");
    printf("   TINGGI GEDUNG = %.2f METER\n\n", tinggiGedung);
    
    /* Konversi ke satuan lain untuk informasi tambahan */
    printf("   Konversi ke satuan lain:\n");
    printf("   - Centimeter (cm)  : %.2f cm\n", tinggiGedung * 100);
    printf("   - Kilometer (km)   : %.6f km\n", tinggiGedung / 1000);
    printf("\n");
    printf("=======================================================\n\n");
}

/*
===============================================================================
BAGIAN 9: FUNGSI TANYA ULANG
===============================================================================
*/

int tanyaUlang() {
    char pilihan;
    
    printf("Apakah Anda ingin mengukur gedung lain? (y/n): ");
    scanf("%c", &pilihan);
    bersihkanBuffer();
    
    /* Return 1 jika user pilih 'y' atau 'Y', 0 jika tidak */
    if(pilihan == 'y' || pilihan == 'Y') {
        return 1;
    } else {
        return 0;
    }
}

/*
===============================================================================
BAGIAN 10: PROGRAM UTAMA (MAIN)
===============================================================================
*/

int main() {
    /* Deklarasi variabel */
    float tinggiPengamat;   /* Tinggi badan pengamat dalam meter */
    float sudutElevasi;     /* Sudut elevasi dalam derajat */
    float jarakPengamat;    /* Jarak horizontal pengamat ke gedung dalam meter */
    float tinggiGedung;     /* Hasil perhitungan tinggi gedung */
    int ulangi;             /* Flag untuk mengulang program */
    
    /* Loop utama program - bisa dijalankan berulang kali */
    do {
        /*
        ===================================================================
        LANGKAH 1: TAMPILKAN HEADER PROGRAM
        ===================================================================
        */
        tampilkanHeader();
        tekanEnter();
        
        /*
        ===================================================================
        LANGKAH 2: TAMPILKAN ILUSTRASI PENGUKURAN
        ===================================================================
        */
        tampilkanIlustrasi();
        tekanEnter();
        
        /*
        ===================================================================
        LANGKAH 3: INPUT DATA PENGUKURAN
        ===================================================================
        */
        inputDataPengukuran(&tinggiPengamat, &sudutElevasi, &jarakPengamat);
        
        /*
        ===================================================================
        LANGKAH 4: VALIDASI INPUT
        ===================================================================
        */
        if(!validasiInput(tinggiPengamat, sudutElevasi, jarakPengamat)) {
            /* Jika input tidak valid, tampilkan pesan dan keluar */
            printf("Program dihentikan karena input tidak valid.\n");
            printf("Silakan jalankan program kembali.\n\n");
            return 1;  /* Keluar dengan kode error */
        }
        
        tekanEnter();
        
        /*
        ===================================================================
        LANGKAH 5: TAMPILKAN DATA INPUT
        ===================================================================
        */
        tampilkanDataInput(tinggiPengamat, sudutElevasi, jarakPengamat);
        tekanEnter();
        
        /*
        ===================================================================
        LANGKAH 6: HITUNG TINGGI GEDUNG
        ===================================================================
        */
        tinggiGedung = hitungTinggiGedung(tinggiPengamat, sudutElevasi, jarakPengamat);
        tekanEnter();
        
        /*
        ===================================================================
        LANGKAH 7: TAMPILKAN HASIL
        ===================================================================
        */
        tampilkanHasil(tinggiGedung);
        
        /*
        ===================================================================
        LANGKAH 8: TANYA APAKAH INGIN MENGULANG
        ===================================================================
        */
        ulangi = tanyaUlang();
        printf("\n");
        
    } while(ulangi);  /* Ulangi selama user memilih 'y' */
    
    /*
    ===================================================================
    PROGRAM SELESAI
    ===================================================================
    */
    printf("=======================================================\n");
    printf("  Terima kasih telah menggunakan program ini!\n");
    printf("=======================================================\n\n");
    
    return 0;  /* Program selesai dengan sukses */
}

/*
===============================================================================
                     CARA MENGGUNAKAN PROGRAM
===============================================================================

1. COMPILE PROGRAM
   Di terminal VS Code, ketik:
   gcc tinggi_gedung.c -o tinggi_gedung -lm
   
   CATATAN: Flag -lm diperlukan untuk link library matematika (math.h)

2. JALANKAN PROGRAM
   Windows: tinggi_gedung.exe
   Linux/Mac: ./tinggi_gedung

3. CONTOH INPUT

   Tinggi badan pengamat: 1.7 [ENTER]
   Sudut elevasi: 45 [ENTER]
   Jarak ke gedung: 50 [ENTER]

4. OUTPUT YANG DIHARAPKAN

   TINGGI GEDUNG = 51.70 METER

===============================================================================
                        PENJELASAN RUMUS
===============================================================================

Rumus dasar trigonometri yang digunakan:

   tan(α) = tinggi tambahan / jarak
   
Maka:
   tinggi tambahan = jarak × tan(α)
   
Dan tinggi total gedung:
   Tinggi Gedung = Tinggi Pengamat + tinggi tambahan

Dimana:
   - α (alpha) = sudut elevasi
   - tan = fungsi tangen dalam trigonometri
   - Tinggi Pengamat = tinggi mata pengamat dari tanah
   - tinggi tambahan = tinggi dari mata pengamat ke puncak gedung

===============================================================================
                            CONTOH KASUS
===============================================================================

KASUS 1:
  Input:
    - Tinggi pengamat: 1.7 meter
    - Sudut elevasi: 45 derajat
    - Jarak: 50 meter
  
  Perhitungan:
    - tan(45°) = 1.0
    - Tinggi tambahan = 50 × 1.0 = 50 meter
    - Tinggi gedung = 1.7 + 50 = 51.7 meter

KASUS 2:
  Input:
    - Tinggi pengamat: 1.65 meter
    - Sudut elevasi: 30 derajat
    - Jarak: 100 meter
  
  Perhitungan:
    - tan(30°) ≈ 0.5774
    - Tinggi tambahan = 100 × 0.5774 = 57.74 meter
    - Tinggi gedung = 1.65 + 57.74 = 59.39 meter

===============================================================================
                            TIPS PENTING
===============================================================================

1. Sudut elevasi harus dalam rentang 0 - 90 derajat
2. Semakin besar sudut, semakin tinggi gedung (dengan jarak sama)
3. Semakin jauh jarak, semakin tidak akurat pengukuran
4. Pastikan pengukuran jarak dilakukan secara horizontal (datar)
5. Tinggi pengamat diukur dari tanah ke mata (bukan ke kepala)

===============================================================================
*/
